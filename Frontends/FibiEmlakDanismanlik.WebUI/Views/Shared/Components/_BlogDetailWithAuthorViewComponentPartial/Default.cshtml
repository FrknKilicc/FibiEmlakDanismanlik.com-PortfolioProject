@model ResultBlogWithAuthorDto

<!--Page Title-->
<section class="page-title centred" style="background-image: url(https://images.stockcake.com/public/e/3/0/e30fd6b9-27e3-4bf8-95ff-ba161c9d5931_large/real-estate-transaction-stockcake.jpg);">
    <div class="auto-container">
        <div class="content-box clearfix">
            <h1>Blog Yazıları</h1>
            <ul class="bread-crumb clearfix">
                <li><a href="@Url.Action("Index", "UILayout")">Anasayfa</a></li>
                <li>Blog Yazıları</li>
            </ul>
        </div>
    </div>
</section>
<!--End Page Title-->
<!-- sidebar-page-container -->
<section class="sidebar-page-container blog-details sec-pad-2">
    <div class="auto-container">
        <div class="row clearfix">
            <div class="col-lg-8 col-md-12 col-sm-12 content-side">
                <div class="blog-details-content">
                    <div class="news-block-one">
                        <div class="inner-box">
                            <div class="image-box">
                                <figure class="image"><img src="@Model.BlogImgUrl" alt=""></figure>
                                <span class="category">Featured</span>
                            </div>
                            <div class="lower-content">
                                <h3>@Model.BlogTitle.</h3>
                                <ul class="post-info clearfix">
                                    <li class="author-box">
                                        <figure class="author-thumb"><img src="@Model.AuthorImgUrl" alt=""></figure>
                                        <h5><a href="blog-details.html">@Model.AuthorName</a></h5>
                                    </li>
                                    <li>@Model.CreatedDate</li>
                                </ul>
                                <div class="text">
                                    <p>@Model.BlogDescription </p>
                                    
                                </div>
                                <div class="post-tags">
                                    <ul class="tags-list clearfix">
                                        <li><h5>Etiketler:</h5></li>
                                        @foreach (var tag in Model.Tags)
                                        {
                                           <li><a href="blog-details.html">@tag.Name</a></li>
                                        }
                                        
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                  
                </div>
            </div>
            <div class="col-lg-4 col-md-12 col-sm-12 sidebar-side">
                <div class="blog-sidebar">
                    <div class="sidebar-widget search-widget">
                        <div class="widget-title">
                            <h4>Arama</h4>
                        </div>
                        <div class="search-inner">
                            <form action="#" method="get" id="blogSearchForm">
                                <div class="form-group" style="position:relative;">
                                    <input type="search"
                                           id="blogSearchInput"
                                           name="q"
                                           placeholder="Blog Ara"
                                           autocomplete="off">

                                    <button type="button"><i class="fas fa-search"></i></button>
                                    
                                    <div id="blogSuggestBox"
                                         class="widget-content"
                                         style="display:none; position:absolute; left:0; right:0; top:100%; z-index:999; background:#fff;">
                                        <ul id="blogSuggestList"
                                            class="category-list clearfix"
                                            style="margin:0;">
                                        </ul>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="sidebar-widget social-widget">
                        <div class="widget-title">
                            <h4>Bizi Takip Edin</h4>
                        </div>
                        <ul class="social-links clearfix">
                            <li><a href="https://www.facebook.com/ankayapiemlakk/?locale=tr_TR" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
                            <li><a href="blog-1.html" target="_blank"><i class="fab fa-google-plus-g"></i></a></li>
                            <li><a href="@Url.Action("Index", "UIlayout")" target="_blank"><i class="fab fa-twitter"></i></a></li>
                            <li><a href="https://www.linkedin.com/in/fibi-emlak-danışmanlık-589173302/?originalSubdomain=tr" target="_blank"><i class="fab fa-linkedin-in"></i></a></li>
                            <li><a href="https://www.instagram.com/fibiemlak/" target="_blank"><i class="fab fa-instagram"></i></a></li>
                        </ul>
                    </div>
                    <div class="sidebar-widget category-widget">
                        <div class="widget-title">
                            <h4>Category</h4>
                        </div>
                        <div class="widget-content">
                            <ul class="category-list clearfix">
                                <li><a href="blog-details.html">Home improvement<span>(9)</span></a></li>
                                <li><a href="blog-details.html">Architecture<span>(5)</span></a></li>
                                <li><a href="blog-details.html">Tips and advice<span>(2)</span></a></li>
                                <li><a href="blog-details.html">Interior<span>(7)</span></a></li>
                                <li><a href="blog-details.html">Real Estate<span>(3)</span></a></li>
                            </ul>
                        </div>
                    </div>
                    @await Component.InvokeAsync("_GetLast3BlogWithAuthorViewComponentPartial")
                  
                    <div class="sidebar-widget tags-widget">
                        <div class="widget-title">
                            <h4>Popular Tags</h4>
                        </div>
                        <div class="widget-content">
                            <ul class="tags-list clearfix">
                                <li><a href="blog-details.html">Real Estate</a></li>
                                <li><a href="blog-details.html">HouseHunting</a></li>
                                <li><a href="blog-details.html">Architecture</a></li>
                                <li><a href="blog-details.html">Interior</a></li>
                                <li><a href="blog-details.html">Sale</a></li>
                                <li><a href="blog-details.html">Rent Home</a></li>
                                <li><a href="blog-details.html">Listing</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- sidebar-page-container -->

<script>
    (function () {
        const input = document.getElementById("blogSearchInput");
        const box = document.getElementById("blogSuggestBox");
        const list = document.getElementById("blogSuggestList");
        const form = document.getElementById("blogSearchForm");

        if (!input || !box || !list) return;

        let timer = null;

        if (form) {
            form.addEventListener("submit", function (e) { e.preventDefault(); });
        }

        function hide() {
            box.style.display = "none";
            list.innerHTML = "";
        }

        function show() {
            box.style.display = "block";
        }

        function escapeHtml(str) {
            return (str || "")
                .replaceAll("&", "&amp;")
                .replaceAll("<", "&lt;")
                .replaceAll(">", "&gt;")
                .replaceAll('"', "&quot;")
                .replaceAll("'", "&#039;");
        }

        async function fetchSuggest(q) {
            const url = `/Blog/Suggest?q=${encodeURIComponent(q)}&take=6`;
            const res = await fetch(url, { headers: { "Accept": "application/json" } });
            if (!res.ok) return [];
            return await res.json();
        }

        function render(items) {
            if (!items || items.length === 0) {
                hide();
                return;
            }
            // Arama spmrası suggested - blog görsel eklenebilir şuan title ve desc suggest ediyor. 

            list.innerHTML = items.map(x => `
                <li style="padding:10px 12px; border-bottom:1px solid #eee;">
                    <a href="/Blog/Detail/${x.blogId}" style="display:block;">
                        <div style="font-weight:600;color : black ; ">${escapeHtml(x.blogTitle)}</div>
                        <div style="font-size:13px; color:black; opacity:.75; margin-top:4px;">
                            ${escapeHtml(x.blogDescPrew)}
                        </div>
                    </a>
                </li>
            `).join("");

            show();
        }

        input.addEventListener("keyup", function () {
            const q = input.value.trim();

            // 2 karakter altı suggestion kapatmalı 
            if (q.length < 2) { hide(); return; }

            clearTimeout(timer);
            timer = setTimeout(async () => {
                try {
                    const items = await fetchSuggest(q);
                    render(items);
                } catch (e) {
                    hide();
                }
            }, 300); // debounce rate standart olarak istenen yapıda / 200 de fazla hızlı. 
        });

        document.addEventListener("click", function (e) {
            if (!box.contains(e.target) && e.target !== input) hide();
        });
    })();
</script>